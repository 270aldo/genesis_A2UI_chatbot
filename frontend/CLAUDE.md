# CLAUDE.md - Genesis Chat (A2UI)

## Project Overview

Genesis Chat is the React + TypeScript frontend for NGX GENESIS. It implements the A2UI pattern: the backend returns structured JSON (text + widget payload) and the frontend renders the correct widget.

## Tech Stack

- **Framework**: React 19 with TypeScript
- **Build Tool**: Vite 6
- **Styling**: Tailwind CSS (via CDN)
- **API Integration**: FastAPI backend (`/api/chat`)
- **Icons**: Lucide React
- **Font**: Inter (Google Fonts)

## Project Structure

```
frontend/
├── App.tsx                    # Main chat UI + message lifecycle
├── index.tsx                  # React entry point
├── index.html                 # HTML template with Tailwind CDN
├── types.ts                   # Shared types (AgentType, WidgetPayload, Attachment)
├── constants.ts               # Colors and helper utilities
├── components/
│   ├── BaseUI.tsx            # Reusable UI primitives
│   ├── Widgets.tsx           # A2UI widget components + mediator
│   └── Sidebar.tsx           # Session sidebar
├── services/
│   ├── api.ts                # Backend API client (main)
│   └── geminiService.ts      # Legacy direct Gemini client (not default)
├── package.json
├── tsconfig.json
└── vite.config.ts
```

## Key Concepts

### A2UI Contract
Responses are JSON objects with:
- `text`: Markdown-compatible text
- `agent`: UPPERCASE agent name (GENESIS/BLAZE/SAGE/SPARK/STELLA/LOGOS)
- `payload`: Optional widget `{ type, props }`

### Agents (Frontend Display)

| Agent | Color | Domain |
|-------|-------|--------|
| GENESIS | #6D00FF | Orchestration, dashboards |
| BLAZE | #EF4444 | Training, strength |
| SAGE | #22C55E | Nutrition, hydration |
| SPARK | #FBBF24 | Habits, check-ins |
| STELLA | #A855F7 | Analytics, mindset |
| LOGOS | #6D00FF | Explanations (text-only) |

### Available Widget Types

- `daily-checkin`
- `quick-actions`
- `workout-card`
- `meal-plan`
- `hydration-tracker`
- `progress-dashboard`
- `recipe-card`
- `sleep-analysis`
- `timer-widget`
- `checklist`
- `supplement-stack`
- `quote-card`
- `alert-banner`
- `live-session-tracker`
- `smart-grocery-list`
- `body-comp-visualizer`
- `plate-calculator`
- `habit-streak`
- `breathwork-guide`

## Development Workflow

### Setup

```bash
npm install
```

### Environment

Optional `.env.local`:
```
VITE_API_URL=http://localhost:8000
```

### Run

```bash
npm run dev
```

## Coding Conventions

- Use explicit prop types.
- Keep widget components in `components/Widgets.tsx`.
- Use `AgentCard` for agent-themed widgets.
- Use `onAction(id, data)` for interactive widgets (emits `SYSTEM_EVENT` to backend).

## Key Files

- `App.tsx`: chat state, message flow, backend health indicator, attachments.
- `services/api.ts`: `/api/chat` client, includes attachments payload.
- `services/geminiService.ts`: legacy direct Gemini path (not used by default).
- `components/Widgets.tsx`: widgets + `A2UIMediator`.
- `constants.ts`: agent colors + helpers.

## Adding New Widgets

1. Add a props interface in `components/Widgets.tsx`.
2. Build the component using `AgentCard`:

```tsx
export const NewWidget: React.FC<{ data: NewWidgetProps; agent?: AgentType }> = ({ data, agent }) => (
  <AgentCard agent={agent} fallback="GENESIS">
    {/* Widget content */}
  </AgentCard>
);
```

3. Add to the `A2UIMediator` switch.
4. Add the type to `WidgetPayload` in `types.ts`.
5. Document in backend agent instructions if needed.

## Important Notes

- Responses must be valid JSON (no Markdown code fences).
- Image attachments are base64 encoded and sent to the backend.
- Voice recording is simulated.
- Session list is mocked in `App.tsx`.

## Common Tasks

### Update System Prompts
Prompts live in `backend/instructions/*.txt` (not in the frontend).

### Add a New Agent
Update `AgentType` in `types.ts`, add a color in `constants.ts`, and ensure backend responses use that agent.

### Change Theme Colors
Edit `COLORS` in `constants.ts`.


<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

*No recent activity*
</claude-mem-context>